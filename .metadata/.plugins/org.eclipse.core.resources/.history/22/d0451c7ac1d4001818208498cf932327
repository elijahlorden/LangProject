package assembler;

import java.util.ArrayList;

import main.Util;

public class Assembler {
	private ArrayList<String> rawLines;

	public Assembler(ArrayList<String> rawLines) {
		this.rawLines = rawLines;
	}

	public void lex() {
		byte section = 0;
		for (int i=0; i<rawLines.size(); i++) {
			String line = rawLines.get(i);
			if (line.length() < 1 || line.charAt(0) == '#') continue;
			removeComments(line);
			if (line.length() < 1 || line.charAt(0) == '#') continue;
			switch(line) {
				case ".data":
					section = 1;
					break;
				case ".text":
					section = 2;
					break;
				default:
					switch(section) {
						case 0:
							Util.error("Assembler", "No section declared", i+1);
							break;
						case 1:
							lexDataLine(line, i+1);
							break;
						case 2:
							break;
						default:
							Util.error("Assembler", "Unknown error", i+1);
							break;
					}
					break;
			}
		}
	}
	
	public void removeComments(String s) {
		if (s.indexOf('$') != -1) return;
		int index = s.indexOf('#');
		if (index == -1) return;
		s = s.substring(0,index);
		System.out.println(s);
	}
	
	public void lexDataLine(String line, int ln) {
		String[] parts = line.split(":");
		if (parts.length < 3) Util.error("Assembler", "Invalid data declaration", ln);
		if (parts[0].charAt(parts[0].length()) != ':') Util.error("Assembler", "Labels must preceed a colon (:)", ln);
		String key = parts[0].substring(0, parts[0].length()-2);
		System.out.println(key);
		
	}
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
}
